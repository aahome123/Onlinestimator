<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>A.A Price Guide | Window & Door Estimates</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{ --blue:#1e5eff; }

body{
font-family:"Segoe UI",system-ui,sans-serif;
background:#f4f7fb;
margin:0;
color:#222;
}

.container{
max-width:1200px;
margin:auto;
padding:28px 16px 60px;
}

header{
text-align:center;
margin-bottom:30px;
}

h1{
font-size:clamp(26px,4vw,34px);
margin-bottom:10px;
}

.subtitle{
font-size:18px;
color:#555;
}

.tabs{
display:flex;
gap:10px;
margin-bottom:30px;
flex-wrap:wrap;
}

.tab-btn{
background:#e4ecff;
color:#1e5eff;
padding:10px 18px;
border-radius:8px;
cursor:pointer;
font-weight:600;
}

.tab-btn.active{
background:var(--blue);
color:#fff;
}

.tab-content{display:none;}
.tab-content.active{display:block;}

.section{
background:#fff;
border-radius:14px;
padding:28px;
margin-bottom:48px;
box-shadow:0 8px 20px rgba(0,0,0,0.08);
}

.section h2{
margin-top:0;
font-size:24px;
}

.row{
display:flex;
flex-wrap:wrap;
gap:14px;
margin-bottom:14px;
}

.row input,
.row select{
flex:1;
padding:12px;
border-radius:8px;
border:1px solid #ccc;
font-size:15px;
}

.checkbox-group{
display:flex;
gap:18px;
flex-wrap:wrap;
margin-top:10px;
}

button{
background:var(--blue);
color:#fff;
border:none;
padding:14px 26px;
font-size:16px;
border-radius:10px;
cursor:pointer;
}

button:hover{background:#184bcc;}

.total-box{
font-size:20px;
margin-top:20px;
font-weight:600;
color:var(--blue);
}

.contact{
text-align:center;
font-size:18px;
margin-top:50px;
}

.admin-box{
background:#f0f5ff;
padding:20px;
border-radius:10px;
margin-top:20px;
display:none;
}
</style>
</head>

<body>
<div class="container">

<header>
<div style="text-align:center; margin-bottom:10px;">
<img src="logo.png" alt="AA Home Solutions Logo" style="max-width:220px;">
</div>
<h1>A.A price tool for Sales Team </h1>
<div class="subtitle">Instant, Professional Window & Door Estimates</div>
</header>

<div class="tabs">
<div class="tab-btn active" onclick="showTab('lead')">Customer Info</div>
<div class="tab-btn" onclick="showTab('windows')">Windows</div>
<div class="tab-btn" onclick="showTab('doors')">Doors</div>
<div class="tab-btn" onclick="showTab('totals')">Project Total</div>
</div>

<div id="lead" class="tab-content active">
<div class="section">
<h2>Start Your Quote</h2>
<div class="row">
<input id="custName" placeholder="Full Name">
<input id="custPhone" placeholder="Phone Number">
</div>
<div class="row">
<input id="custEmail" placeholder="Email">
<input id="custAddress" placeholder="Property Address">
</div>
</div>
</div>

<div id="windows" class="tab-content">
<div id="windowContainer"></div>
<button onclick="addWindow()">Add Window</button>
</div>

<div id="doors" class="tab-content">
<div id="doorContainer"></div>
<button onclick="addDoor()">Add Door</button>
</div>

<div id="totals" class="tab-content">
<div class="section">
<h2>Project Summary</h2>

<div class="total-box">
MSRP: $<span id="subtotal">0.00</span><br><br>
Discount: $<span id="discountAmount">0.00</span><br><br>
Discounted Price: $<span id="grandTotal">0.00</span>
</div>

<br>
<input id="discountCode" placeholder="Enter Discount Code" oninput="updateTotals()">

<br><br>
<button onclick="adminLogin()">Admin Review</button>

<div class="admin-box" id="adminBox">
<label>Margin %</label>
<input type="number" id="marginPercent" value="40" oninput="updateTotals()">
<br><br>
Estimated Profit: $<span id="profitAmount">0.00</span>

<br><br>
<strong>Commission Tracker</strong><br>
Commission Rate: <span id="commissionRate">0</span>%<br><br>
Rep Commission: $<span id="commissionAmount">0.00</span>
</div>

<br><br>
<button onclick="sendQuote()">Finalize & Send Quote</button>

</div>
</div>

<div class="contact">
For Manager-On-Duty Call Alex Alfonso
  561-568-8858
</div>

</div>

<script>

const ADMIN_PASSWORD="Veronica22";

const DISCOUNT_CODES={
"5":5,
"10":10,
"15":15,
"20":20,
"25":25,
"VET":15,
"facebook":27,  
"Firstresponder":15,
"freeinstall":25,
"VIP15":15,
"SHOWCASEHOME":23
};

const windowBase={
"Sliding":{w:71,h:48,p:2000},
"Single Hung":{w:36,h:48,p:1850},
"Casement":{w:36,h:48,p:2000},
"Picture":{w:50,h:40,p:2500},
"Three-Light Slider (XOX)":{w:110,h:60,p:4000}
};

const doorBase={
"French Door":{w:71,h:81,p:5100},
"Single Entry Door":{w:36,h:81,p:3250},
"Sliding Glass Door":{w:71,h:81,p:4900}
};

let windowTotals=[];
let doorTotals=[];

function showTab(id){
document.querySelectorAll(".tab-content").forEach(t=>t.classList.remove("active"));
document.querySelectorAll(".tab-btn").forEach(b=>b.classList.remove("active"));
document.getElementById(id).classList.add("active");

document.querySelectorAll(".tab-btn").forEach(btn=>{
if(btn.getAttribute("onclick")?.includes(id)){
btn.classList.add("active");
}
});
}

function addWindow(){
let div=document.createElement("div");
div.className="section";
div.innerHTML=`
<h2>Window</h2>
<div class="row">
<select class="type">
<option>Sliding</option>
<option>Single Hung</option>
<option>Casement</option>
<option>Picture</option>
<option>Three-Light Slider (XOX)</option>
</select>
<input type="number" class="w" placeholder="Width">
<input type="number" class="h" placeholder="Height">
<input type="number" class="qty" placeholder="Qty" value="1" min="1">
</div>
<div class="checkbox-group">
<label><input type="checkbox" class="lowe"> Low-E </label>
<label><input type="checkbox" class="insul"> Insulated </label>
<label><input type="checkbox" class="insulair"> White Interlayer </label>
<label><input type="checkbox" class="grid"> Grid </label>
</div>
<div class="total-box">Price: $<span class="price">0.00</span></div>
<button onclick="deleteItem(this,'window')">Delete</button>
`;

div.querySelectorAll("input,select").forEach(el=>{
el.oninput=()=>calcWindowItem(div);
});

windowContainer.appendChild(div);
windowTotals.push(0);
}

function addDoor(){
let div=document.createElement("div");
div.className="section";
div.innerHTML=`
<h2>Door</h2>
<div class="row">
<select class="type">
<option>French Door</option>
<option>Single Entry Door</option>
<option>Sliding Glass Door</option>
</select>
<input type="number" class="w" placeholder="Width">
<input type="number" class="h" placeholder="Height">
<input type="number" class="qty" placeholder="Qty" value="1" min="1">
</div>
<div class="checkbox-group">
<label><input type="checkbox" class="lowe"> Low-E </label>
<label><input type="checkbox" class="insul"> Insulated </label>
<label><input type="checkbox" class="insulair"> White Interlayer </label>
<label><input type="checkbox" class="grid"> Grid </label>
</div>
<div class="total-box">Price: $<span class="price">0.00</span></div>
<button onclick="deleteItem(this,'door')">Delete</button>
`;

div.querySelectorAll("input,select").forEach(el=>{
el.oninput=()=>calcDoorItem(div);
});

doorContainer.appendChild(div);
doorTotals.push(0);
}

function deleteItem(btn,type){
let section=btn.parentElement;
let container=section.parentElement;
let index=[...container.children].indexOf(section);
section.remove();
if(type==="window"){windowTotals[index]=0;}
if(type==="door"){doorTotals[index]=0;}
updateTotals();
}

function calcWindowItem(div){
let base=windowBase[div.querySelector(".type").value];
let w=div.querySelector(".w").value;
let h=div.querySelector(".h").value;

if(!w||!h){
div.querySelector(".price").innerText="0.00";
updateTotals();
return;
}

let price=(w*h)/(base.w*base.h)*base.p;

let qty = parseInt(div.querySelector(".qty").value) || 1;

if(div.querySelector(".lowe").checked) price*=1.05;
if(div.querySelector(".insul").checked) price*=1.15;
if(div.querySelector(".insulair").checked) price+=250;
if(div.querySelector(".grid").checked) price+=175;

price = price * qty;
div.querySelector(".price").innerText=price.toFixed(2);
updateTotals();
}

function calcDoorItem(div){
let base=doorBase[div.querySelector(".type").value];
let w=div.querySelector(".w").value;
let h=div.querySelector(".h").value;

if(!w||!h){
div.querySelector(".price").innerText="0.00";
updateTotals();
return;
}

let price=(w*h)/(base.w*base.h)*base.p;

if(div.querySelector(".lowe").checked) price*=1.05;
if(div.querySelector(".insul").checked) price*=1.15;
if(div.querySelector(".insulair").checked) price+=250;
if(div.querySelector(".grid").checked) price+=175;
let qty = parseInt(div.querySelector(".qty").value) || 1;
price = price * qty;

div.querySelector(".price").innerText=price.toFixed(2);
updateTotals();
}
function updateTotals(){

let subtotal=0;
document.querySelectorAll(".price").forEach(p=>{
subtotal+=parseFloat(p.innerText)||0;
});

let code=document.getElementById("discountCode").value.toUpperCase();
let discountPercent=DISCOUNT_CODES[code]||0;
let discount=subtotal*(discountPercent/100);
let grand=subtotal-discount;

document.getElementById("subtotal").innerText=subtotal.toFixed(2);
document.getElementById("discountAmount").innerText=discount.toFixed(2);
document.getElementById("grandTotal").innerText=grand.toFixed(2);

let margin=document.getElementById("marginPercent").value||0;
let profit=grand*(margin/100);
document.getElementById("profitAmount").innerText=profit.toFixed(2);

// Commission logic based on discount %
let commissionRate=0;

if(discountPercent<=10){commissionRate=10;}
else if(discountPercent<=20){commissionRate=7;}
else if(discountPercent<=25){commissionRate=5;}
else if(discountPercent<=26){commissionRate=2;}
else{commissionRate=0;}

let commission=grand*(commissionRate/100);

document.getElementById("commissionRate").innerText=commissionRate;
document.getElementById("commissionAmount").innerText=commission.toFixed(2);

}

function adminLogin(){
let pass=prompt("Enter Admin Password");
if(pass===ADMIN_PASSWORD){
document.getElementById("adminBox").style.display="block";
}else alert("Incorrect Password");
}

addWindow();
addDoor();
function sendQuote(){

const data = new URLSearchParams();
data.append("name", document.getElementById("custName").value);
data.append("phone", document.getElementById("custPhone").value);
data.append("email", document.getElementById("custEmail").value);
data.append("address", document.getElementById("custAddress").value);
data.append("subtotal", document.getElementById("subtotal").innerText);
data.append("discount", document.getElementById("discountAmount").innerText);
data.append("grandTotal", document.getElementById("grandTotal").innerText);
data.append("commission", document.getElementById("commissionAmount").innerText);

fetch("https://script.google.com/macros/s/AKfycbzCvUaHOL8tXchWvOdNg41garZPrR7oMjua6AdsUl6Dt-7x1epFsvoA9LSRwk1GXuLC/exec", {
  method: "POST",
  body: data
})
.then(res => res.text())
.then(res => {
  alert("Quote Saved Successfully!");
})
.catch(err => {
  alert("Error Saving Quote");
  console.error(err);
});

}

</script>
</body>

</html>























